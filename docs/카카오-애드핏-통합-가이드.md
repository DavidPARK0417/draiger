# 카카오 애드핏(AdFit) 통합 가이드

## 📋 개요

카카오 애드핏 심사 통과를 위한 필수 사항과 통합 방법을 안내합니다.

---

## ✅ 심사 통과 필수 사항

### 1. 소유권 확인

- ✅ **완료**: 푸터에 소유주 정보 추가
  - 소유주: 박용범
  - 이메일: decidepyb@gmail.com
  - 위치: `src/components/Footer.tsx`

### 2. SEO 최적화 (검색 엔진 노출)

- ✅ **완료**: 기본 SEO 설정
  - `sitemap.xml` 자동 생성 (`src/app/sitemap.ts`)
  - `robots.txt` 설정 (`src/app/robots.ts`)
  - 메타데이터 설정 (`src/app/layout.tsx`)
  - 구조화된 데이터 (JSON-LD) 추가

### 3. 트래픽 품질

- 정상적인 트래픽 확보 필요
- 검색 엔진 유입 증가 권장
- 자연스러운 사용자 유입 유지

---

## 🔧 카카오 애드핏 통합 방법

### 1. 애드핏 계정 설정

1. [카카오 애드핏](https://adfit.kakao.com/) 접속
2. 매체 등록 및 심사 신청
3. 심사 통과 후 광고 단위 ID 발급

### 2. 광고 단위 ID 발급

심사 통과 후 다음 정보를 받게 됩니다:

- **광고 단위 ID**: `DAN-gzhM4ZoHUUTxO6Kg` (현재 사용 중)
- **광고 형식**: 배너 (250x250)
- **광고 크기**: 250px × 250px

### 3. 환경 설정

#### 3.1. 기본적인 광고 스크립트 설정

공식 문서에 따르면, 광고를 노출할 페이지에 다음과 같은 광고 설정 스크립트를 삽입합니다:

```html
<ins class="kakao_ad_area" style="display:none;width:100%;"
 data-ad-unit    = "광고단위ID"
 data-ad-width   = "광고단위 가로 사이즈"
 data-ad-height  = "광고단위 세로 사이즈"></ins>
<script async type="text/javascript" charset="utf-8" src="https://t1.daumcdn.net/kas/static/ba.min.js"></script>
```

**현재 프로젝트 구현 상태:**
- ✅ `AdFit` 컴포넌트가 공식 문서 형식을 정확히 준수
- ✅ `layout.tsx`에서 스크립트를 `</body>` 바로 위에 설치 (공식 문서 권장)
- ✅ `charset="utf-8"` 속성 포함
- ✅ `async` 속성 포함 (Next.js Script 컴포넌트의 `strategy="afterInteractive"` 사용)

#### 3.2. NO-AD 콜백 설정

광고 요청이 실패하거나 노출할 광고가 없는 경우에 이를 제어하도록 NO-AD 콜백 함수를 설정할 수 있습니다.

공식 문서에 따르면:

```html
<ins ...
 data-ad-onfail   = "callBackFunc" // NO-AD시 실행될 Callback 함수명
 ... ></ins>

<script type="text/javascript">
 function callBackFunc(arg1) {
   /*
    * TODO: 기능 구현
    */
 }
</script>
```

Callback 함수 실행시 `ins` 태그 객체를 첫 번째 인자(`arg1`)로 전달 받습니다. 또한 한 페이지 내 2개 이상의 광고단위 설치 시 Callback 메서드 명을 달리 해야 합니다.

**현재 프로젝트 구현 상태:**
- ✅ `AdFit` 컴포넌트의 `onFail` prop을 통해 NO-AD 콜백 함수 지원
- ✅ 자동으로 고유한 콜백 함수명 생성 (`adfitCallback_{unitId}`)
- ✅ 여러 광고 단위 사용 시 자동으로 다른 콜백 함수명 사용

---

## 💻 코드 통합 방법

> **⚠️ 중요**: 광고 스크립트 안에 담긴 광고단위 정보는 변경해서 설치해서는 안됩니다.  
> 코드를 수정해서 설치할 경우 광고 요청에 실패하거나 잘못된 광고 요청으로 처리될 수 있습니다.

### 공식 문서 준수 사항

[AdFit Web SDK 공식 문서](https://github.com/adfit/adfit-web-sdk)에 따라 다음 사항을 준수해야 합니다:

1. **기본 광고 스크립트 형식**:
   ```html
   <ins class="kakao_ad_area" style="display:none;width:100%;"
    data-ad-unit    = "광고단위ID"
    data-ad-width   = "광고단위 가로 사이즈"
    data-ad-height  = "광고단위 세로 사이즈"></ins>
   <script async type="text/javascript" charset="utf-8" src="https://t1.daumcdn.net/kas/static/ba.min.js"></script>
   ```

2. **스크립트 설치 위치**: 페이지 맨 하단에 `</body>` 부분 바로 위에 설치하는 것이 좋습니다.

3. **NO-AD 콜백 함수**: 한 페이지 내 2개 이상의 광고단위 설치 시 Callback 메서드 명을 달리 해야 합니다.

### 방법 1: 컴포넌트로 통합 (권장)

#### 1. 애드핏 컴포넌트

`src/components/AdFit.tsx` 파일에 이미 구현되어 있으며, 공식 문서를 정확히 준수합니다.

**공식 문서 준수 사항:**
- ✅ `<ins class="kakao_ad_area" style="display:none;width:100%;"` 형식 정확히 준수
- ✅ `data-ad-unit`, `data-ad-width`, `data-ad-height` 속성 사용
- ✅ `layout.tsx`에서 스크립트를 `</body>` 바로 위에 설치 (공식 문서 권장)
- ✅ NO-AD 콜백 함수 지원 (`onFail` prop)
- ✅ `charset="utf-8"` 속성 포함
- ✅ AdFit 스크립트가 자동으로 `<ins>` 태그를 스캔하여 광고 표시

**컴포넌트 Props:**
- `unitId` (필수): 카카오 애드핏 광고 단위 ID
- `width` (선택): 광고 너비 (기본값: 320)
- `height` (선택): 광고 높이 (기본값: 100)
- `className` (선택): 추가 CSS 클래스
- `onFail` (선택): NO-AD 콜백 함수 (광고 요청 실패 시 실행)

#### 2. 페이지에 광고 추가

**예시 1: 기본 사용 (메인 페이지)**

```typescript
import AdFit from "@/components/AdFit";

export default function Home() {
  return (
    <div>
      {/* 콘텐츠 */}

      {/* 광고 영역 */}
      <div className="my-8 flex justify-center">
        <AdFit
          unitId="DAN-gzhM4ZoHUUTxO6Kg"
          width={250}
          height={250}
          className="rounded-lg"
        />
      </div>

      {/* 콘텐츠 */}
    </div>
  );
}
```

**예시 2: NO-AD 콜백 함수 사용**

```typescript
import AdFit from "@/components/AdFit";

export default function Home() {
  const handleAdFail = (element: HTMLElement) => {
    console.log("광고 로드 실패", element);
    // 대체 콘텐츠 표시 또는 다른 광고 스크립트 로드
  };

  return (
    <div>
      <div className="my-8 flex justify-center">
        <AdFit
          unitId="DAN-gzhM4ZoHUUTxO6Kg"
          width={250}
          height={250}
          onFail={handleAdFail}
        />
      </div>
    </div>
  );
}
```

**예시 3: 반응형 광고 배치**

```typescript
import AdFit from "@/components/AdFit";

export default function Home() {
  return (
    <div>
      {/* 모바일: 250x250 */}
      <div className="flex justify-center sm:hidden">
        <AdFit
          unitId="DAN-gzhM4ZoHUUTxO6Kg"
          width={250}
          height={250}
        />
      </div>

      {/* 태블릿/데스크탑: 728x90 */}
      <div className="hidden sm:flex justify-center">
        <AdFit
          unitId="DAN-gzhM4ZoHUUTxO6Kg"
          width={728}
          height={90}
        />
      </div>
    </div>
  );
}
```

### 방법 2: 레이아웃에 직접 통합

`src/app/layout.tsx`에 직접 추가 (현재 이미 구현되어 있음):

```typescript
// </body> 바로 위에 설치 (공식 문서 권장)
<Script
  src="https://t1.daumcdn.net/kas/static/ba.min.js"
  strategy="afterInteractive"
  type="text/javascript"
  charSet="utf-8"
/>
```

**공식 문서 준수 사항:**
- ✅ 스크립트를 `</body>` 바로 위에 설치
- ✅ `async` 속성 포함 (Next.js Script 컴포넌트의 `strategy="afterInteractive"` 사용)
- ✅ `type="text/javascript"` 속성 포함
- ✅ `charset="utf-8"` 속성 포함

**광고 영역은 각 페이지에서 `<AdFit>` 컴포넌트를 사용하여 추가합니다.**

---

## 📍 권장 광고 배치 위치

### 1. 메인 페이지 (`src/app/page.tsx`)

- 카테고리 섹션 사이에 배치
- 콘텐츠와 자연스럽게 통합

### 2. 인사이트 상세 페이지 (`src/app/insight/[slug]/page.tsx`)

- 본문 상단 또는 하단
- 사이드바 (데스크탑)

### 3. 도구 페이지

- 계산 결과 하단
- 페이지 하단

### 4. 푸터 상단

- 모든 페이지 하단에 일관되게 배치

---

## 🎨 디자인 시스템 적용

### 광고 컨테이너 스타일

```typescript
<div
  className="
  my-8
  flex justify-center
  bg-gray-50 dark:bg-gray-800
  p-4
  rounded-lg
  border border-gray-100 dark:border-gray-700
  shadow-sm dark:shadow-gray-900/30
"
>
  <AdFit 
    unitId="DAN-gzhM4ZoHUUTxO6Kg" 
    width={250} 
    height={250} 
  />
</div>
```

### 반응형 광고

```typescript
// 모바일: 250x250
// 태블릿: 728x90
// 데스크탑: 970x250

{/* 모바일 전용 */}
<div className="flex justify-center sm:hidden">
  <AdFit 
    unitId="DAN-gzhM4ZoHUUTxO6Kg" 
    width={250} 
    height={250} 
  />
</div>

{/* 태블릿 전용 */}
<div className="hidden sm:flex lg:hidden justify-center">
  <AdFit 
    unitId="DAN-gzhM4ZoHUUTxO6Kg" 
    width={728} 
    height={90} 
  />
</div>

{/* 데스크탑 전용 */}
<div className="hidden lg:flex justify-center">
  <AdFit 
    unitId="DAN-gzhM4ZoHUUTxO6Kg" 
    width={970} 
    height={250} 
  />
</div>
```

---

## 🔍 SEO 최적화 확인 사항

### 1. Sitemap 확인

```bash
# 개발 서버 실행 후
curl http://localhost:3000/sitemap.xml
```

### 2. Robots.txt 확인

```bash
curl http://localhost:3000/robots.txt
```

### 3. 메타데이터 확인

- 브라우저 개발자 도구에서 `<head>` 태그 확인
- 구조화된 데이터 (JSON-LD) 확인

### 4. 검색 엔진 등록

- [Google Search Console](https://search.google.com/search-console) 등록
- [Naver Search Advisor](https://searchadvisor.naver.com/) 등록
- 사이트맵 제출

---

## 📊 트래픽 품질 개선 방법

### 1. 콘텐츠 최적화

- 정기적인 콘텐츠 업데이트
- SEO 친화적인 제목과 설명
- 관련 키워드 활용

### 2. 소셜 미디어 공유

- SNS를 통한 자연스러운 유입
- 콘텐츠 공유 기능 추가

### 3. 검색 엔진 최적화

- 메타 태그 최적화
- 구조화된 데이터 활용
- 내부 링크 구조 개선

---

## ⚠️ 주의사항

### 1. 광고 스크립트 수정 금지

> **🚨 CRITICAL**: 광고 스크립트 안에 담긴 광고단위 정보는 변경해서 설치해서는 안됩니다.  
> 코드를 수정해서 설치할 경우 광고 요청에 실패하거나 잘못된 광고 요청으로 처리될 수 있습니다.

- 광고 단위 ID, 크기 등 정보는 정확히 입력해야 합니다
- 공식 문서에 명시된 형식을 정확히 준수해야 합니다
- `<ins>` 태그의 `class`, `style`, `data-ad-*` 속성을 임의로 변경하지 마세요

### 2. 스크립트 설치 위치

- 스크립트는 페이지 맨 하단에 `</body>` 부분 바로 위에 설치하는 것이 좋습니다
- 다른 리소스에 영향을 주지 않도록 주의해야 합니다

### 3. NO-AD 콜백 함수 명명 규칙

- 한 페이지 내 2개 이상의 광고단위 설치 시 Callback 메서드 명을 달리 해야 합니다
- `AdFit` 컴포넌트는 자동으로 고유한 콜백 함수명을 생성합니다

### 4. 외부 광고 스크립트 연동 시 주의사항

- 외부 광고 스크립트를 삽입하는 경우 동일한 사이즈의 외부 광고를 사용하여야 합니다
- 외부 광고 코드 유형은 반드시 "비동기" 방식을 사용하여야 합니다

### 5. 광고 배치 규칙

- 콘텐츠를 가리지 않도록 주의
- 사용자 경험을 해치지 않는 위치에 배치
- 과도한 광고 배치 금지

### 6. 클릭 유도 금지

- 광고 클릭을 유도하는 문구 사용 금지
- 자동 클릭 방지
- 정상적인 트래픽 유지

### 7. 개인정보 보호

- 광고 스크립트는 개인정보를 수집하지 않도록 설정
- GDPR, 개인정보보호법 준수

### 8. 운영 정책 준수

- 사이트/앱 운영정책에 위반되는 경우 적립금 지급이 거절될 수 있으니 유의하시기 바랍니다
- [사이트/앱 운영 정책](https://adfit.kakao.com/web/html/use%5Fkakao.html) 확인 필수

---

## 🚀 배포 전 체크리스트

- [ ] 푸터에 소유주 정보 추가 확인
- [ ] SEO 메타데이터 설정 확인
- [ ] Sitemap.xml 생성 확인
- [ ] Robots.txt 설정 확인
- [ ] 구조화된 데이터 (JSON-LD) 확인
- [ ] 광고 단위 ID 발급 완료
- [ ] 광고 컴포넌트 통합 완료
- [ ] 반응형 디자인 적용 확인
- [ ] 다크모드 지원 확인
- [ ] 검색 엔진 등록 완료

---

## 📝 참고 자료

- [AdFit Web SDK 공식 GitHub 문서](https://github.com/adfit/adfit-web-sdk) - **공식 가이드**
- [카카오 애드핏 공식 문서](https://adfit.kakao.com/)
- [카카오 애드핏 개발자 가이드](https://adfit.kakao.com/guide)
- [Next.js Script 컴포넌트](https://nextjs.org/docs/app/api-reference/components/script)
- [카카오 애드핏 고객센터](https://cs.kakao.com/helps?service=160&locale=ko)
- [사이트/앱 운영 정책](https://adfit.kakao.com/web/html/use%5Fkakao.html)

---

## 📝 NO-AD 콜백 함수 사용법

광고 요청이 실패하거나 노출할 광고가 없는 경우 대체 콘텐츠를 표시할 수 있습니다.

> **⚠️ 중요**: 한 페이지 내 2개 이상의 광고단위 설치 시 Callback 메서드 명을 달리 해야 합니다.  
> `AdFit` 컴포넌트는 자동으로 고유한 콜백 함수명을 생성합니다 (`adfitCallback_{unitId}`).

### 공식 문서 준수 사항

공식 문서에 따르면 NO-AD 콜백 함수는 다음과 같이 설정합니다:

```html
<ins class="kakao_ad_area" style="display:none;width:100%;"
     data-ad-unit="ADUNIT_ID"
     data-ad-width="250"
     data-ad-height="250"
     data-ad-onfail="callBackFunc"></ins>

<script type="text/javascript">
 function callBackFunc(arg1) {
   /*
    * TODO: 기능 구현
    */
 }
</script>
```

Callback 함수 실행시 `ins` 태그 객체를 첫 번째 인자(`arg1`)로 전달 받습니다.

### 기본 사용법 (컴포넌트)

```typescript
<AdFit
  unitId="DAN-gzhM4ZoHUUTxO6Kg"
  width={250}
  height={250}
  onFail={(element) => {
    // 광고 로드 실패 시 실행될 코드
    // element는 ins 태그 객체 (HTMLElement)
    console.log("광고 로드 실패", element);
    
    // 대체 콘텐츠 표시 예시
    element.innerHTML = `
      <div style="width: 250px; height: 250px; background: #f3f4f6; display: flex; align-items: center; justify-content: center;">
        <p>광고를 불러올 수 없습니다</p>
      </div>
    `;
  }}
/>
```

### 외부 광고 스크립트 연동 (예: Google AdSense)

> **⚠️ 중요**: 외부 광고 스크립트를 삽입하는 경우 동일한 사이즈의 외부 광고를 사용하여야 합니다.  
> 외부 광고 코드 유형은 반드시 "비동기" 방식을 사용하여야 합니다.

```typescript
<AdFit
  unitId="DAN-gzhM4ZoHUUTxO6Kg"
  width={250}
  height={250}
  onFail={(element) => {
    // AdFit 광고 실패 시 Google AdSense 로드
    // 공식 문서 예시를 참고하여 동일한 사이즈 사용
    const adSenseCode = `
      <ins class="adsbygoogle"
           style="display:inline-block;width:250px;height:250px"
           data-ad-client="ca-pub-XXXXX"
           data-ad-slot="XXXXX"></ins>
    `;
    element.innerHTML = adSenseCode;
    
    // Google AdSense 스크립트 로드 (비동기 방식)
    if (typeof window !== 'undefined' && (window as any).adsbygoogle) {
      ((window as any).adsbygoogle = (window as any).adsbygoogle || []).push({});
    }
  }}
/>
```

### 여러 광고 단위 사용 시 주의사항

한 페이지에 여러 광고 단위를 사용하는 경우, 각각 다른 콜백 함수명을 사용해야 합니다:

```typescript
// 첫 번째 광고 단위
<AdFit
  unitId="DAN-gzhM4ZoHUUTxO6Kg"
  width={250}
  height={250}
  onFail={(element) => {
    console.log("첫 번째 광고 실패", element);
  }}
/>

// 두 번째 광고 단위 (다른 unitId 사용)
<AdFit
  unitId="DAN-3zxEkFXjkDNH2T9G"
  width={300}
  height={250}
  onFail={(element) => {
    console.log("두 번째 광고 실패", element);
  }}
/>
```

`AdFit` 컴포넌트는 자동으로 각 광고 단위 ID를 기반으로 고유한 콜백 함수명을 생성하므로, 수동으로 콜백 함수명을 지정할 필요가 없습니다.

---

## 🔄 업데이트 이력

- **2026-01-XX**: AdFit Web SDK 공식 문서 반영
  - [AdFit Web SDK 공식 GitHub 문서](https://github.com/adfit/adfit-web-sdk) 내용 반영
  - 공식 문서 준수 사항 명시
  - 광고 스크립트 수정 금지 경고 추가
  - 스크립트 설치 위치 명확화 (`</body>` 바로 위)
  - NO-AD 콜백 함수 명명 규칙 설명 추가
  - 외부 광고 스크립트 연동 시 주의사항 추가
  - 운영 정책 준수 안내 추가
- **2026-01-XX**: AdFit Web SDK 가이드 반영
  - NO-AD 콜백 함수 지원 추가
  - `charset="utf-8"` 속성 추가
  - 실제 광고 단위 ID 적용 (`DAN-gzhM4ZoHUUTxO6Kg`)
  - 로깅 기능 추가
  - 외부 광고 스크립트 연동 예시 추가
- **2026-01-XX**: 초기 문서 작성
  - 푸터 소유주 정보 추가
  - SEO 최적화 강화
  - 구조화된 데이터 추가

---

**작성자**: 박용범 (decidepyb@gmail.com)  
**최종 업데이트**: 2026-01-XX
